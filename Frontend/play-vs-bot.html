<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Play vs Bot - CHESSMATE</title>
    <link rel="shortcut icon" type="image/x-icon" href="./assets/favicon.ico">
    <link rel="stylesheet" href="./styles/play-vs-bot.css">
</head>
<body>
    <div class="app">
        <div class="header">
            <div class="game-info">
                <h1>‚ôüÔ∏è Chess Game (Canvas)</h1>
                <p id="gameStatus">Choose game mode to start</p>
            </div>
        </div>

        <!-- Main Menu -->
        <div id="mainMenu" class="menu">
            <h2>Choose Game Mode</h2>
            <div class="menu-buttons">
                <button onclick="showDifficultyMenu()" class="mode-btn">
                    ü§ñ Play vs AI Bot
                </button>
            </div>
        </div>

        <!-- Color Selection Menu (NEW) -->
        <div id="colorMenu" class="difficulty-menu hidden">
            <h2>Choose Your Color</h2>
            <p class="difficulty-subtitle">Select which side you want to play:</p>
            <div class="color-grid">
                <div class="color-card">
                    <button onclick="selectColor('white')" class="color-btn">
                        <div class="color-icon">‚ôî</div>
                        <div class="color-name">White</div>
                        <div class="color-desc">You play first</div>
                    </button>
                </div>
                <div class="color-card">
                    <button onclick="selectColor('black')" class="color-btn">
                        <div class="color-icon">‚ôö</div>
                        <div class="color-name">Black</div>
                        <div class="color-desc">Bot plays first</div>
                    </button>
                </div>
                <div class="color-card">
                    <button onclick="selectColor('random')" class="color-btn">
                        <div class="color-icon">üé≤</div>
                        <div class="color-name">Random</div>
                        <div class="color-desc">50/50 chance</div>
                    </button>
                </div>
            </div>
            <button onclick="backToMenu()" class="back-btn">‚Üê Back to Menu</button>
        </div>

        <!-- Difficulty Selection Menu -->
        <div id="difficultyMenu" class="difficulty-menu hidden">
            <h2>Choose Bot Difficulty</h2>
            <p class="difficulty-subtitle">Select your challenge level:</p>
            <div class="difficulty-grid">
                <div class="difficulty-card">
                    <button onclick="startBotGame(1)" class="difficulty-btn">
                        <div class="difficulty-level">
                            <span class="level-emoji">üòä</span>
                            <span class="level-number">Level 1</span>
                        </div>
                        <div class="difficulty-desc">Beginner - Random</div>
                    </button>
                </div>
                <div class="difficulty-card">
                    <button onclick="startBotGame(3)" class="difficulty-btn">
                        <div class="difficulty-level">
                            <span class="level-emoji">üôÇ</span>
                            <span class="level-number">Level 3</span>
                        </div>
                        <div class="difficulty-desc">Easy - Rule-based</div>
                    </button>
                </div>
                <div class="difficulty-card">
                    <button onclick="startBotGame(5)" class="difficulty-btn">
                        <div class="difficulty-level">
                            <span class="level-emoji">ü§î</span>
                            <span class="level-number">Level 5</span>
                        </div>
                        <div class="difficulty-desc">Medium - Lichess API</div>
                    </button>
                </div>
                <div class="difficulty-card">
                    <button onclick="startBotGame(8)" class="difficulty-btn">
                        <div class="difficulty-level">
                            <span class="level-emoji">üò§</span>
                            <span class="level-number">Level 8</span>
                        </div>
                        <div class="difficulty-desc">Hard - Lichess API</div>
                    </button>
                </div>
                <div class="difficulty-card">
                    <button onclick="startBotGame(10)" class="difficulty-btn">
                        <div class="difficulty-level">
                            <span class="level-emoji">üî•</span>
                            <span class="level-number">Level 10</span>
                        </div>
                        <div class="difficulty-desc">Expert - Lichess API</div>
                    </button>
                </div>
                <div class="difficulty-card">
                    <button onclick="startBotGame(15)" class="difficulty-btn">
                        <div class="difficulty-level">
                            <span class="level-emoji">üî•</span>
                            <span class="level-number">Level 15</span>
                        </div>
                        <div class="difficulty-desc">Master - Lichess API</div>
                    </button>
                </div>
            </div>
            <button onclick="backToDifficultyMenu()" class="back-btn">‚Üê Back</button>
        </div>

        <!-- Game Controls -->
        <div id="gameControls" class="game-controls hidden">
            <button onclick="backToMenu()" class="back-btn">Back to Menu</button>
            <div class="bot-controls">
                <span class="bot-info" id="botLevelInfo">Playing vs Bot Level 5 ü§î</span>
                <span class="color-info" id="playerColorInfo">You are White ‚ôî</span>
                <button onclick="restartGame()" class="restart-btn">üîÑ New Game</button>
                <button onclick="flipBoard()" class="flip-btn">üîÑ Flip Board</button>
            </div>
        </div>

        <!-- Canvas Chessboard -->
        <div id="chessboardContainer" class="chessboard-container hidden">
            <canvas id="chessCanvas" width="640" height="640"></canvas>
            <div id="gameOverOverlay" class="game-over hidden">
                <p>Game Over</p>
                <p id="winnerText">Winner: White</p>
                <p>Press Enter to restart</p>
            </div>
        </div>
    </div>

    <!-- Load Chess.js only -->
    <script src="./libs/chess.js/dist/cjs/chess.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Loading Canvas Chess Game...');
            
            if (typeof Chess !== 'undefined') {
                window.Chess = Chess;
                
                try {
                    const testGame = new Chess();
                    console.log('‚úÖ Chess.js working:', testGame.fen());
                    document.getElementById('gameStatus').textContent = 'Choose game mode to start';
                } catch (error) {
                    console.error('‚ùå Chess.js test failed:', error);
                    document.getElementById('gameStatus').textContent = '‚ùå Chess library error';
                }
            } else {
                console.error('‚ùå Chess.js not found');
                document.getElementById('gameStatus').textContent = '‚ùå Chess library not found';
            }
        });
    </script>
    
    <script src="./js/play-vs-bot.js"></script>
</body>
</html>